<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MindCheck - Your Mental Wellness Companion</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">   
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    </head>
<body data-user-role="{{ user_role }}"></body>>
    
    <div class="container">
        <div class="header">
            <div class="header-content">
                <h1><i class="fas fa-brain"></i> MindCheck</h1>
                <p>Your safe space to understand and track your emotional wellbeing</p>
                <p style="font-size: 0.9em; margin-top: 5px; opacity: 0.8;">
                    Welcome, <span id="userEmail">User</span> 
                    <span class="role-badge" id="userRoleBadge" style="margin-left: 10px;"></span>
                </p>
            </div>
            <div class="header-nav">
                <button class="nav-btn active" onclick="showSection('checkin')">Daily Check-in</button>
                <button class="nav-btn" onclick="showSection('dashboard')">My Dashboard</button>
                <button class="nav-btn" onclick="window.location.href='/logout'">Logout</button>
            </div>
        </div>

        <div id="checkinSection" class="main-section">
            <div class="input-section">
                <h2>How's your heart feeling today?</h2>
                <p class="subtitle">Share what's on your mind - no judgment, just understanding</p>
                
                <div class="input-method active" id="textInputMethod">
                    <textarea id="textInput" placeholder="For example: Today feels heavy. I woke up with that familiar ache in my chest and can't seem to shake this fog..."></textarea>
                </div>

                <div class="input-method" id="voiceInputMethod" style="display: none;">
                    <div class="voice-recorder">
                        <button id="recordBtn" class="record-btn">
                            <i class="fas fa-microphone"></i>
                            <span>Click to start recording</span>
                        </button>
                        <div id="recordingStatus" class="recording-status">
                            <div class="wave-animation">
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                            </div>
                            <p>Listening... speak from your heart</p>
                        </div>
                        <div id="recordingResult" class="recording-result">
                            <p><strong>We heard:</strong> "<span id="transcribedText"></span>"</p>
                            <button class="retry-btn" onclick="retryRecording()"><i class="fas fa-redo"></i> Try again</button>
                        </div>
                    </div>
                </div>

                <div class="input-toggle">
                    <button class="toggle-btn active" onclick="toggleInputMethod('text')">
                        <i class="fas fa-keyboard"></i> Write it down
                    </button>
                    <button class="toggle-btn" onclick="toggleInputMethod('voice')">
                        <i class="fas fa-microphone"></i> Speak your heart
                    </button>
                </div>
                <div class="button-container">
                    <button id="analyzeBtn" onclick="analyzeInput()" class="primary-btn">
                        <i class="fas fa-heartbeat"></i> Understand my feelings
                    </button>
                </div>

                <div class="disclaimer">
                    <p>üíù <strong>You're safe here:</strong> This is your private space. Nothing you share is stored or judged.</p>
                    <p>ü§ù <strong>Remember:</strong> This is a supportive tool, not a replacement for professional care when needed.</p>
                </div>
            </div>

            <div id="loadingSection" class="loading-section" style="display: none;">
                <div class="spinner"></div>
                <p>Listening carefully to your words...</p>
            </div>

            <div id="resultSection" class="result-section" style="display: none;">
                <div class="result-header">
                    <h2>Here's what we noticed together</h2>
                    <button class="save-btn" onclick="showSection('dashboard')"> 
                        <i class="fas fa-chart-line"></i> View Trends
                    </button>
                </div>
                
                <div class="text-preview">
                    <strong>You shared:</strong> "<span id="textPreview"></span>"
                </div>

                <div class="weather-report">
                    <h3><i class="fas fa-cloud-sun"></i> Your emotional weather today</h3>
                    <div class="weather-card" id="emotionalWeather">
                        <div class="weather-icon">
                            <i class="fas fa-cloud-rain" id="weatherEmoji"></i>
                        </div>
                        <div class="weather-details">
                            <div class="weather-main" id="weatherMain">Partly Cloudy</div>
                            <div class="weather-desc" id="weatherDesc">With occasional showers of anxiety</div>
                        </div>
                    </div>
                </div>

                <div class="insight-card" id="moodCard">
                    <h3><i class="fas fa-cloud"></i> Your mood pattern</h3>
                    <div class="insight-level" id="moodLevel"></div>
                    <div class="insight-explanation" id="moodExplanation"></div>
                    
                    <div class="progress-container">
                        <label>Mood Level:</label>
                        <div class="progress-bar">
                            <div class="progress-fill-base"></div>
                            <div class="progress-fill-clip" id="moodScoreFill"></div>
                        </div>
                        <span class="progress-value" id="moodScoreValue"></span>
                    </div>
                </div>

                <div class="insight-card" id="stressCard">
                    <h3><i class="fas fa-wind"></i> Stress & pressure</h3>
                    <div class="insight-level" id="stressLevel"></div>
                    <div class="insight-explanation" id="stressExplanation"></div>
                    
                    <div class="progress-container">
                        <label>Tension levels:</label>
                        <div class="progress-bar">
                            <div class="progress-fill-base"></div>
                            <div class="progress-fill-clip" id="stressScoreFill"></div>
                        </div>
                        <span class="progress-value" id="stressScoreValue"></span>
                    </div>
                </div>

                <div class="emotions-section">
                    <h3><i class="fas fa-heart"></i> The feelings we found</h3>
                    <p>Most present right now: <strong id="dominantEmotion"></strong></p>
                    <div class="emotion-cloud" id="emotionCloud"></div>
                </div>

                <div class="suggestions">
                    <h3><i class="fas fa-hands-helping"></i> Gentle suggestions for today</h3>
                    <div class="suggestions-grid" id="suggestionsGrid"></div>
                </div>

                <div class="support-section">
                    <h4><i class="fas fa-life-ring"></i> Always here for you</h4>
                    <div class="support-grid">
                        <div class="support-item">
                            <div class="support-icon">üíù</div>
                            <strong>National Mental Health Hepline</strong>
                            <p>Call : 08046110007</p>
                            <small>Available 24/7</small>
                        </div>
                        <div class="support-item">
                            <div class="support-icon">ü§ù</div>
                            <strong>Crisis Text Line</strong>
                            <p>Text: HOME to 741741</p>
                            <small></small>
                        </div>
                        <div class="support-item">
                            <div class="support-icon">üè•</div>
                            <strong>Emergency Help</strong>
                            <p>Dial: 112</p>
                            <small>All-in-one emergency number</small>
                        </div>
                    </div>
                </div>
            </div>

            <div id="errorSection" class="error-section" style="display: none;">
                <div class="error-message">
                    <i class="fas fa-exclamation-triangle"></i>
                    <span id="errorMessage"></span>
                </div>
            </div>
        </div>

        <div id="dashboardSection" class="main-section" style="display: none;">
            <div class="dashboard-header">
                <h2><i class="fas fa-chart-line"></i> Your emotional journey</h2>
                <p>Tracking how you've been feeling over time</p>
            </div>

            <div class="dashboard-grid">
                <div class="dashboard-card full-width">
                    <h3>Combined Wellbeing (This Week)</h3>
                    <div class="week-chart">
                         <canvas id="weekChartCanvas"></canvas>
                    </div>
                </div>

                <div class="dashboard-card">
                    <h3>Mood Trend</h3>
                    <div class="trend-chart">
                        <canvas id="moodTrendChartCanvas"></canvas>
                    </div>
                </div>

                <div class="dashboard-card">
                    <h3>Stress waves</h3>
                    <div class="trend-chart">
                         <canvas id="stressTrendChartCanvas"></canvas>
                    </div>
                </div>

                <div class="dashboard-card">
                    <h3>Common feelings</h3>
                    <div class="emotion-summary" id="emotionSummary"></div>
                </div>

                <div class="dashboard-card full-width">
                    <h3>Your recent reflections</h3>
                    <div class="reflections-list" id="reflectionsList"></div>
                </div>
            </div>

            <div class="weekly-summary">
                <h3><i class="fas fa-star"></i> Weekly insights</h3>
                <div class="insights-grid" id="weeklyInsights"></div>
            </div>
        </div>
    </div>
<script src="{{ url_for('static', filename='script.js') }}"></script>


</body>
</html>